<?php require_once "../../../inc/comm_program.php"; ?>
<?php
	Setting::$doc_title = "메뉴관리 목록";
	Setting::$doc_layout = "default";
?>
<?php Layout::getHeaderAdmin(); ?>
<?php require_once $_SERVER['DOCUMENT_ROOT'] . Setting::WEB_ROOT . "/class/service/MenuService.php"; ?>
<?php
	$menu_list = MenuService::getListMenu($req_params);
?>
<?= StringUtil::setDefault(Request::getParam("menu_name"), Text::getText("root")); ?>
	<form action="menu_proc.php" method="post" name="f">
		<input type="hidden" name="work_flag">
		<table class="tbl1 th_center td_center">
			<tr>
				<td class="th">
					<input class="js chk_all_item" type="checkbox" title="<?= Text::getText("Select all item") ?>">
				</td>
				<td class="th"><?= Text::getText("MENU_NAME") ?></td>
				<td class="th"><?= Text::getText("MENU_URL") ?></td>
				<td class="th"></td>
			</tr>
			<?php
				if (count($menu_list)) { ?>
					<?php foreach ($menu_list as $row => $menu_data) { ?>
						<tr>
							<td>
								<input title="<?= Text::getText("Select item") ?>" name="menu_code[]" class="chk_item" type="checkbox"
										 value="<?= $menu_data["menu_code"] ?>">
							</td>
							<td>
								<a href="menu_list.html?<?= Request::getQueryStringWith(
									array(
										"menu_level" => $menu_data["menu_level"] + 1,
										"ref_menu_code" => $menu_data["menu_code"],
										"menu_name" => $menu_data["menu_name"]
									)
								); ?>"><?= $menu_data["menu_name"] ?></a>
							</td>
							<td class="align_left">
								<a href="<?= Setting::WEB_ROOT . $menu_data["menu_url"] ?>" target="_blank">
									<?= Setting::WEB_ROOT . $menu_data["menu_url"] ?>
								</a>
							</td>
							<td>
								<a class="btn btn_small" href="menu_write.html?<?= Request::getQueryStringWith(
									array("work_flag" => "edit",
										"menu_code" => $menu_data["menu_code"]
									)
								); ?>"><?= Text::getText("edit") ?>
								</a>
							</td>
						</tr>
					<? } ?>
				<? } else { ?>
					<tr>
						<td colspan="10" class="align_center">
							<?= Text::getText("NO_DATA"); ?>
						</td>
					</tr>
				<? } ?>
		</table>
		
		<div class="btn_w">
			<a class="btn" href="menu_write.html?<?= Request::getQueryStringWith(
				array(
					"work_flag" => "write"
				)) ?>"><?= Text::getText("write"); ?>
			</a>
			<button class="btn" type="button" onclick="deleteMenus();">
				<?= Text::getText("delete"); ?>
			</button>
		</div>
	</form>
<?php require_once $_SERVER["DOCUMENT_ROOT"] . "/site/inc/comm_js.php"; ?>
	<script>
		UI.checkAll(".chk_all_item", ".chk_item");

		function deleteMenus() {
			var f = document.f;
			f.work_flag.value = "delete";
			if (confirm('<?=Text::getText("CONFIRM_DELETE")?>')) {
				f.submit();
			}
		}
	</script>
<?php Layout::getFooterAdmin(); ?>